    <div class="modal fade" id="installModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" style="font-weight:bold;">ğŸ“² æŠŠåœŸåœ°å…¬å¸¶å›å®¶</h5>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-success" style="font-size:0.9rem;">
                        å®‰è£å¾Œå¯å…¨è¢å¹•ç€è¦½ï¼Œå°±åƒçœŸçš„ APP ä¸€æ¨£æ–¹ä¾¿ï¼
                    </div>
                    
                    <div id="ios-guide" style="display:none;">
                        <h6 style="font-weight:bold; color:#007aff;"><i class="fab fa-apple"></i> iPhone ç”¨æˆ¶ï¼š</h6>
                        <ol style="padding-left:20px; line-height:1.8;">
                            <li>é»æ“Šä¸‹æ–¹ <b>ã€Œåˆ†äº«ã€</b> <i class="fas fa-external-link-alt"></i></li>
                            <li>é¸æ“‡ <b>ã€ŒåŠ å…¥ä¸»ç•«é¢ã€</b> <i class="far fa-plus-square"></i></li>
                            <li>æŒ‰å³ä¸Šè§’ <b>ã€Œæ–°å¢ã€</b></li>
                        </ol>
                    </div>

                    <div id="android-guide" style="display:none;">
                        <h6 style="font-weight:bold; color:#3ddc84;"><i class="fab fa-android"></i> Android ç”¨æˆ¶ï¼š</h6>
                        <ol style="padding-left:20px; line-height:1.8;">
                            <li>é»æ“Šå³ä¸Šè§’ <b>ã€Œé¸å–®ã€</b> <i class="fas fa-ellipsis-v"></i></li>
                            <li>é¸æ“‡ <b>ã€ŒåŠ åˆ°ä¸»ç•«é¢ã€</b> æˆ– <b>ã€Œå®‰è£ã€</b> ğŸ“²</li>
                            <li>æŒ‰ä¸‹ <b>ã€Œæ–°å¢ã€</b> å³å¯å®Œæˆ</li>
                        </ol>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary btn-block" data-dismiss="modal">æˆ‘çŸ¥é“äº†</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>
    
    <script>
        $(document).ready(function() {
            loadMiniLeaderboard();
        });

        function loadMiniLeaderboard() {
            $.getJSON('/api/locations', function(data) {
                var userCounts = {};
                data.forEach(item => {
                    var rawName = item.nickname || 'ç†±å¿ƒä¸²å‹'; 
                    var name = (rawName === 'åŒ¿å') ? 'ç†±å¿ƒä¸²å‹' : rawName;
                    userCounts[name] = (userCounts[name] || 0) + 1;
                });
                var sortedUsers = Object.entries(userCounts).sort((a,b) => b[1] - a[1]);

                var html = '';
                sortedUsers.slice(0, 3).forEach((item, index) => {
                    var icon = ['ğŸ¥‡', 'ğŸ¥ˆ', 'ğŸ¥‰'][index];
                    html += `
                        <li class="list-group-item d-flex justify-content-between align-items-center" style="padding:10px 15px;">
                            <span>${icon} <b>${item[0]}</b></span>
                            <span class="badge badge-light" style="color:#d63031; font-weight:bold;">${item[1]} å°Š</span>
                        </li>
                    `;
                });
                $('#mini-leaderboard').html(html);
            });
        }

        function showInstallGuide() {
            var userAgent = navigator.userAgent || navigator.vendor || window.opera;
            var isIOS = /iPad|iPhone|iPod/.test(userAgent) && !window.MSStream;
            if (isIOS) { $('#ios-guide').show(); $('#android-guide').hide(); } 
            else { $('#ios-guide').hide(); $('#android-guide').show(); }
            $('#installModal').modal('show');
        }
    </script>
</body>
</html>
