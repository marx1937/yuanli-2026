{% extends "base.html" %}
{% set active_page = "index" %}

{% block title %}å°‹ç¥æƒ…å ±ç«™ (Hç‰ˆ){% endblock %}

{% block styles %}
<style>
    /* 1. ç¶“å…¸èƒŒæ™¯ï¼šç±³è‰²é»é» (é‚„åŸèˆŠç«™è³ªæ„Ÿ) */
    body {
        background-color: #fdfcf0;
        background-image: radial-gradient(#d7ccc8 1.5px, transparent 1.5px);
        background-size: 24px 24px;
        font-family: "Microsoft JhengHei", sans-serif;
    }

    /* 2. é ‚éƒ¨æ©«å¹… (é‚„åŸèˆŠç«™æ¨£å¼ï¼Œä½†åŠ å…¥å‹•æ…‹åŠŸèƒ½) */
    .hero-banner {
        background: #fff8e1;
        border: 2px solid #ffe0b2;
        border-radius: 20px;
        padding: 15px 20px;
        margin: 25px 20px 15px 20px;
        display: flex;
        align-items: center;
        box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        cursor: pointer;
        transition: transform 0.2s;
    }
    .hero-banner:active { transform: scale(0.98); }
    
    .hero-mascot { width: 55px; margin-right: 15px; filter: drop-shadow(0 2px 3px rgba(0,0,0,0.1)); }
    .hero-text { color: #5d4037; font-weight: bold; font-size: 1rem; flex: 1; line-height: 1.4; }
    .hero-arrow { color: #d7ccc8; font-size: 0.9rem; }

    /* 3. å¡ç‰‡é€šç”¨æŒ‰éˆ• (åœ“æ½¤ã€é™°å½±ã€å¤§åœ–ç¤º) */
    .card-btn {
        display: flex;
        align-items: center;
        border-radius: 25px;
        padding: 20px 25px;
        margin: 15px 20px;
        text-decoration: none !important;
        position: relative;
        overflow: hidden;
        transition: transform 0.2s;
        box-shadow: 0 8px 20px rgba(0,0,0,0.1);
        height: 110px; /* å›ºå®šé«˜åº¦è®“ç‰ˆé¢æ•´é½Š */
    }
    .card-btn:active { transform: scale(0.98); }

    /* ç´…è‰²å¡ç‰‡ (Lucky/ä¸Šå‚³) */
    .card-red {
        background: linear-gradient(135deg, #d32f2f 0%, #c62828 100%);
        color: white;
    }
    
    /* é»ƒè‰²å¡ç‰‡ (åœ°åœ–) */
    .card-yellow {
        background: #fff9c4;
        border: 2px solid #fff176;
        color: #5d4037;
    }

    /* ç™½è‰²å¡ç‰‡ (å½±åƒåº«) */
    .card-white {
        background: #fff;
        border: 2px solid #eee;
        color: #5d4037;
    }

    /* å¡ç‰‡å…§å®¹æ’ç‰ˆ */
    .card-img { width: 80px; height: 80px; object-fit: contain; margin-right: 20px; filter: drop-shadow(0 4px 4px rgba(0,0,0,0.1)); }
    .card-info { flex: 1; }
    .card-title { font-size: 1.5rem; font-weight: bold; display: block; margin-bottom: 5px; }
    .card-desc { font-size: 0.9rem; opacity: 0.9; }

    /* Lucky æ¨™ç±¤ (é‚„åŸèˆŠç«™è§’åº¦) */
    .lucky-tag {
        position: absolute; top: 18px; right: -30px;
        background: #f1c40f; color: #d35400;
        font-weight: bold; padding: 5px 40px;
        transform: rotate(15deg); font-size: 0.8rem;
        box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        z-index: 10;
    }

    /* åº•éƒ¨è³‡è¨Š */
    .footer-area { text-align: center; padding: 30px 0 120px 0; }
    .footer-text { color: #b0bec5; font-size: 0.85rem; }
    .mark-r { color: #d32f2f; font-weight: bold; vertical-align: super; font-size: 0.7rem; margin-left: 2px; }
</style>
{% endblock %}

{% block content %}

    <div class="hero-banner" onclick="location.reload()">
        <img src="https://res.cloudinary.com/diuoghid2/image/upload/v1/mascot_camera.png" class="hero-mascot">
        <div class="hero-text" id="news-ticker">
            æ­¡è¿ä¾†åˆ°å°‹ç¥æƒ…å ±ç«™ï¼<br>
            <span style="font-size:0.85rem; color:#8d6e63; font-weight:normal;">æ­£åœ¨é€£ç·š Hotmail ç¸½éƒ¨...</span>
        </div>
        <i class="fas fa-chevron-right hero-arrow"></i>
    </div>

    <a href="/upload" class="card-btn card-red">
        <div class="lucky-tag">LUCKY!</div>
        <img src="https://res.cloudinary.com/diuoghid2/image/upload/v1/mascot_camera.png" class="card-img">
        <div class="card-info">
            <span class="card-title">å°‹æ‰¾ç¥éšŠå‹</span>
            <span class="card-desc">è¶•å¿«å¹«ç¥‚æ‹å¼µç…§</span>
        </div>
    </a>

    <a href="/map" class="card-btn card-yellow">
        <img src="https://res.cloudinary.com/diuoghid2/image/upload/v1/mascot_map.png" class="card-img">
        <div class="card-info">
            <span class="card-title">æœå°‹æ–¹ä½</span>
            <span class="card-desc">çœ‹çœ‹ä»–å€‘èº²åœ¨å“ª</span>
        </div>
        <i class="fas fa-map-marked-alt" style="font-size:1.5rem; color:#fbc02d;"></i>
    </a>

    <a href="/gallery" class="card-btn card-white">
        <img src="https://res.cloudinary.com/diuoghid2/image/upload/v1/mascot_couple.png" class="card-img">
        <div class="card-info">
            <span class="card-title">å½±åƒåº«</span>
            <span class="card-desc">å°‹ç¥è¶³è·¡ç´€éŒ„</span>
        </div>
        <i class="fas fa-images" style="font-size:1.5rem; color:#bdbdbd;"></i>
    </a>

    <div class="footer-area">
        <div class="footer-text">
            2026 è‹‘è£¡ä¸²èµ·ä¾†<span class="mark-r">Â®</span> (Hotmail Ver.)
        </div>
    </div>

{% endblock %}

{% block scripts %}
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    $(document).ready(function() {
        // ğŸ”¥ è‡ªå‹•æŠ“å–æœ€æ–°æƒ…å ±ï¼Œä½†é¡¯ç¤ºåœ¨ã€ŒèˆŠç‰ˆæ¨£å¼ã€çš„æ©«å¹…è£¡
        $.getJSON('/api/locations', function(data) {
            if (data && data.length > 0) {
                var latest = data[data.length - 1]; 
                
                // æŠ“æš±ç¨±èˆ‡åœ°é»
                var nickname = latest.nickname || "ç†±å¿ƒé„‰è¦ª";
                var area = "è‹‘è£¡æŸè™•";
                var desc = latest.description || "";
                
                // å˜—è©¦è§£æåœ°é» [xxxé‡Œ]
                if (desc.indexOf(']') > -1) {
                    var parts = desc.split(']');
                    if (parts.length > 0) {
                        area = parts[0].replace('[', ''); 
                    }
                }

                // æ›´æ–°æ©«å¹…æ–‡å­—
                $('#news-ticker').html(`
                    <span style="color:#e65100;">æœ€æ–°æƒ…å ±ï¼š</span><br>
                    <b>${nickname}</b> åœ¨ <b>${area}</b> ç™¼ç¾äº†åœŸåœ°å…¬ï¼
                `);
            } else {
                $('#news-ticker').html("æ­¡è¿ä¾†åˆ°å°‹ç¥æƒ…å ±ç«™ï¼<br><span style='font-size:0.85rem;font-weight:normal;'>ç›®å‰å°šç„¡æƒ…å ±ï¼Œå¿«ä¾†æ¶é ­é¦™</span>");
            }
        }).fail(function() {
            $('#news-ticker').html("æ­¡è¿ä¾†åˆ°å°‹ç¥æƒ…å ±ç«™ï¼");
        });
    });
</script>
{% endblock %}
