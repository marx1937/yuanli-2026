<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>è‹‘è£¡åœŸåœ°å…¬æ–‡åŒ–å¹³å°</title>
    
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    
    <style>
        body {
            background-color: #fdf5e6; /* ç±³è‰²èƒŒæ™¯ï¼Œé…åˆä½ çš„åœ–ç‰‡ */
            font-family: "Microsoft JhengHei", sans-serif;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* é ‚éƒ¨å¤§åœ–å€å¡Š */
        .hero-section {
            position: relative;
            text-align: center;
            background-color: #fdf5e6;
        }
        
        /* ä½ çš„æ©«å¹…åœ–ç‰‡ (top.png) */
        .top-banner {
            width: 100%;
            height: auto;
            display: block;
        }

        /* ä¸»æ¨™é¡Œæ–‡å­—å€ */
        .title-area {
            padding: 20px;
            text-align: center;
            color: #444;
        }
        .main-title {
            font-size: 1.8rem;
            font-weight: bold;
            color: #333;
            letter-spacing: 1px;
            margin-bottom: 5px;
        }
        .sub-title {
            font-size: 0.95rem;
            color: #888;
        }

        /* æŒ‰éˆ•å®¹å™¨ */
        .menu-container {
            padding: 0 30px 30px 30px;
            max-width: 500px;
            margin: 0 auto;
            width: 100%;
            display: flex;
            flex-direction: column;
            gap: 15px; /* æŒ‰éˆ•ä¹‹é–“çš„é–“è· */
        }

        /* é€šç”¨æŒ‰éˆ•æ¨£å¼ */
        .menu-btn {
            display: block;
            width: 100%;
            padding: 15px;
            border-radius: 50px; /* åœ“è§’è† å›Šç‹€ */
            text-decoration: none;
            color: white;
            font-size: 1.2rem;
            font-weight: bold;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.1s;
            border: none;
            position: relative;
        }
        .menu-btn:active { transform: scale(0.98); }
        .menu-btn:hover { text-decoration: none; color: white; opacity: 0.95; }
        
        .menu-btn i { margin-right: 8px; }

        /* ç´…è‰²æŒ‰éˆ• (æŸ¥å ±) */
        .btn-upload {
            background-color: #d32f2f;
            padding: 20px 15px; /* ç¨å¾®å¤§ä¸€é» */
        }
        
        /* é»ƒè‰²æŒ‰éˆ• (åœ°åœ–é€²åº¦) */
        .btn-progress {
            background-color: #ffc107;
            color: #856404; /* å­—é«”æ·±é»ƒè‰²æ¯”è¼ƒæ¸…æ¥š */
        }
        .btn-progress:hover { color: #856404; }

        /* è—è‰²æŒ‰éˆ• (åœ–åº«) */
        .btn-gallery {
            background-color: #17a2b8;
        }

        /* ç²‰è‰²æŒ‰éˆ• (è¯çµ¡) */
        .btn-contact {
            background-color: #ffebee;
            color: #d32f2f;
            border: 1px solid #ffcdd2;
            font-size: 1rem;
            padding: 12px;
        }
        .btn-contact:hover { color: #d32f2f; }

        /* ğŸ† è¦ªè¡›éšŠæ’è¡Œæ¦œå€å¡Š (ç™½è‰²å¡ç‰‡) */
        .rank-card {
            background: white;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            margin-top: 10px;
            border-top: 4px solid #d32f2f; /* é ‚éƒ¨ç´…ç·š */
            position: relative;
        }

        .rank-header {
            text-align: center;
            font-weight: bold;
            color: #d32f2f;
            font-size: 1.1rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .rank-header i { margin-right: 8px; }

        /* æ’è¡Œæ¦œåˆ—è¡¨ */
        .rank-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .rank-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px dashed #eee;
            font-size: 0.95rem;
        }
        .rank-item:last-child { border-bottom: none; }
        
        /* çç‰Œæ¨£å¼ */
        .rank-badge {
            width: 24px;
            height: 24px;
            line-height: 24px;
            text-align: center;
            border-radius: 50%;
            color: white;
            font-size: 0.8rem;
            font-weight: bold;
            display: inline-block;
            margin-right: 8px;
        }
        .rank-1 { background-color: #FFD700; box-shadow: 0 2px 5px rgba(255, 215, 0, 0.4); } /* é‡‘ */
        .rank-2 { background-color: #C0C0C0; } /* éŠ€ */
        .rank-3 { background-color: #CD7F32; } /* éŠ… */

        /* åº•éƒ¨ç‰ˆæ¬Š */
        footer {
            text-align: center;
            padding: 20px;
            color: #aaa;
            font-size: 0.8rem;
            margin-top: auto;
        }
        
    </style>
</head>
<body>

    <div class="hero-section">
        <img src="/static/top.png" alt="Banner" class="top-banner">
    </div>

    <div class="title-area">
        <div class="main-title">è‹‘è£¡åœŸåœ°å…¬æ–‡åŒ–å¹³å°</div>
        <div class="sub-title">ä¸²å‹å‹•èµ·ä¾†ï¼ä¸€èµ·å®Œæˆé€™å¼µåœ°åœ–ï¼</div>
    </div>

    <div class="menu-container">
        
        <a href="/upload" class="menu-btn btn-upload">
            <div><i class="fas fa-camera"></i> ç«‹å³æä¾›åœŸåœ°å…¬ä½ç½®</div>
            <div style="font-size: 0.9rem; font-weight: normal; margin-top: 5px; opacity: 0.9;">(ç¼ºä½ é€™å¼µç…§ç‰‡ï¼)</div>
        </a>

        <a href="/map" class="menu-btn btn-progress">
            <i class="fas fa-map-marked-alt"></i> æŸ¥çœ‹ç›®å‰åœ°åœ–é€²åº¦
        </a>

        <a href="/leaderboard" class="menu-btn btn-gallery">
            <i class="fas fa-images"></i> æ¬£è³åœŸåœ°å…¬åœ–åº«
        </a>

        <a href="https://line.me/R/ti/p/@yuanli" target="_blank" class="menu-btn btn-contact">
            <i class="fas fa-comments"></i> ç«™å‹™å»ºè­° / è¯çµ¡å°ç·¨
        </a>

        <div class="rank-card">
            <div class="rank-header">
                <i class="fas fa-shield-alt"></i> åœŸåœ°å…¬è¦ªè¡›éšŠ
            </div>
            
            <div id="mini-leaderboard">
                <div class="text-center text-muted p-3">
                    <i class="fas fa-spinner fa-spin"></i> è³‡æ–™è®€å–ä¸­...
                </div>
            </div>
            
            <div id="empty-msg" style="display:none; text-align: center; color: #888; font-size: 0.9rem; padding: 10px;">
                ç†±å¿ƒä¸²å‹æ‹›å‹Ÿä¸­...<br>å¿«å»ç•¶ç¬¬ä¸€åï¼
            </div>
        </div>

    </div>

    <footer>
        è‹‘è£¡ä¸²èµ·ä¾† Â© 2026 | <a href="/login" style="color: #ccc; text-decoration: none;">ç®¡ç†å“¡</a>
    </footer>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script>
        $(document).ready(function() {
            // å‘¼å«å¾Œç«¯ API æŠ“å–æ’è¡Œæ¦œè³‡æ–™
            $.getJSON('/api/leaderboard_data', function(data) {
                var users = data.by_user; // å–å¾—å€‹äººæ’è¡Œæ¦œ
                var html = '';

                if (users.length === 0) {
                    // å¦‚æœæ²’æœ‰è³‡æ–™ï¼Œé¡¯ç¤ºæ‹›å‹Ÿè¨Šæ¯
                    $('#mini-leaderboard').hide();
                    $('#empty-msg').show();
                } else {
                    // å¦‚æœæœ‰è³‡æ–™ï¼Œåªé¡¯ç¤ºå‰ 3 å
                    html += '<ul class="rank-list">';
                    // å–å‰ 3 å (slice 0, 3)
                    users.slice(0, 3).forEach(function(user, index) {
                        var rank = index + 1;
                        var badgeClass = '';
                        if(rank === 1) badgeClass = 'rank-1';
                        else if(rank === 2) badgeClass = 'rank-2';
                        else if(rank === 3) badgeClass = 'rank-3';

                        html += `
                            <li class="rank-item">
                                <div>
                                    <span class="rank-badge ${badgeClass}">${rank}</span>
                                    <span style="font-weight:bold; color:#555;">${user.name}</span>
                                </div>
                                <div style="color:#d32f2f; font-weight:bold;">
                                    ${user.count} <small style="color:#999; font-weight:normal;">è™•</small>
                                </div>
                            </li>
                        `;
                    });
                    html += '</ul>';
                    
                    // æŠŠç”¢ç”Ÿçš„ HTML å¡é€²å»
                    $('#mini-leaderboard').html(html);
                    
                    // å¦‚æœè³‡æ–™è¶…é 3 ç­†ï¼Œå¯ä»¥åŠ ä¸€å€‹ "æŸ¥çœ‹æ›´å¤š" çš„é€£çµ
                    if(users.length > 3) {
                         $('#mini-leaderboard').append('<div class="text-center mt-2"><a href="/leaderboard" style="font-size:0.85rem; color:#999;">æŸ¥çœ‹å®Œæ•´æ¦œå–® &raquo;</a></div>');
                    }
                }
            }).fail(function() {
                // å¦‚æœ API å£æ‰æˆ–ç¶²è·¯ä¸é€š
                $('#mini-leaderboard').html('<div class="text-center text-muted">æš«æ™‚ç„¡æ³•è®€å–æ’è¡Œ</div>');
            });
        });
    </script>

</body>
</html>
