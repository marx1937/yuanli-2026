{% extends "base.html" %}
{% set active_page = "index" %}

{% block title %}尋神情報站 (H版){% endblock %}

{% block styles %}
<style>
    /* 1. 經典背景：米色點點 */
    body {
        background-color: #fdfcf0;
        background-image: radial-gradient(#d7ccc8 1.5px, transparent 1.5px);
        background-size: 24px 24px;
        font-family: "Microsoft JhengHei", sans-serif;
    }

    /* 2. 頂部橫幅 */
    .hero-banner {
        background: #fff8e1;
        border: 2px solid #ffe0b2;
        border-radius: 20px;
        padding: 15px 20px;
        margin: 25px 20px 15px 20px;
        display: flex;
        align-items: center;
        box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        cursor: pointer;
        transition: transform 0.2s;
    }
    .hero-banner:active { transform: scale(0.98); }
    
    .hero-mascot { width: 55px; margin-right: 15px; filter: drop-shadow(0 2px 3px rgba(0,0,0,0.1)); }
    .hero-text { color: #5d4037; font-weight: bold; font-size: 1rem; flex: 1; line-height: 1.4; }
    .hero-arrow { color: #d7ccc8; font-size: 0.9rem; }

    /* 3. 卡片通用樣式 */
    .card-btn {
        display: flex;
        align-items: center;
        border-radius: 25px;
        padding: 20px 25px;
        margin: 15px 20px;
        text-decoration: none !important;
        position: relative;
        overflow: hidden;
        transition: transform 0.2s;
        box-shadow: 0 8px 20px rgba(0,0,0,0.1);
        height: 110px;
    }
    .card-btn:active { transform: scale(0.98); }

    /* 紅色卡片 */
    .card-red {
        background: linear-gradient(135deg, #d32f2f 0%, #c62828 100%);
        color: white;
    }
    
    /* 黃色卡片 */
    .card-yellow {
        background: #fff9c4;
        border: 2px solid #fff176;
        color: #5d4037;
    }

    /* 白色卡片 */
    .card-white {
        background: #fff;
        border: 2px solid #eee;
        color: #5d4037;
    }

    /* 卡片圖片與文字 */
    .card-img { width: 80px; height: 80px; object-fit: contain; margin-right: 20px; filter: drop-shadow(0 4px 4px rgba(0,0,0,0.1)); }
    .card-info { flex: 1; }
    .card-title { font-size: 1.5rem; font-weight: bold; display: block; margin-bottom: 5px; }
    .card-desc { font-size: 0.9rem; opacity: 0.9; }

    /* Lucky 標籤 */
    .lucky-tag {
        position: absolute; top: 18px; right: -30px;
        background: #f1c40f; color: #d35400;
        font-weight: bold; padding: 5px 40px;
        transform: rotate(15deg); font-size: 0.8rem;
        box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        z-index: 10;
    }

    /* 底部區域 */
    .footer-area { text-align: center; padding: 30px 0 120px 0; }
    .footer-text { color: #b0bec5; font-size: 0.85rem; }
    .mark-r { color: #d32f2f; font-weight: bold; vertical-align: super; font-size: 0.7rem; margin-left: 2px; }
</style>
{% endblock %}

{% block content %}

    <div class="hero-banner" onclick="location.reload()">
        <img src="/static/mascot_camera.png" class="hero-mascot" onerror="this.src='https://cdn-icons-png.flaticon.com/512/3063/3063823.png'">
        <div class="hero-text" id="news-ticker">
            歡迎來到尋神情報站！<br>
            <span style="font-size:0.85rem; color:#8d6e63; font-weight:normal;">連線 Hotmail 總部中...</span>
        </div>
        <i class="fas fa-chevron-right hero-arrow"></i>
    </div>

    <a href="/upload" class="card-btn card-red">
        <div class="lucky-tag">LUCKY!</div>
        <img src="/static/mascot_camera.png" class="card-img" onerror="this.src='https://cdn-icons-png.flaticon.com/512/3687/3687412.png'">
        <div class="card-info">
            <span class="card-title">尋找神隊友</span>
            <span class="card-desc">趕快幫祂拍張照</span>
        </div>
    </a>

    <a href="/map" class="card-btn card-yellow">
        <img src="/static/mascot_map.png" class="card-img" onerror="this.src='https://cdn-icons-png.flaticon.com/512/854/854878.png'">
        <div class="card-info">
            <span class="card-title">搜尋方位</span>
            <span class="card-desc">看看他們躲在哪</span>
        </div>
        <i class="fas fa-map-marked-alt" style="font-size:1.5rem; color:#fbc02d;"></i>
    </a>

    <a href="/gallery" class="card-btn card-white">
        <img src="/static/mascot_couple.png" class="card-img" onerror="this.src='https://cdn-icons-png.flaticon.com/512/833/833281.png'">
        <div class="card-info">
            <span class="card-title">影像庫</span>
            <span class="card-desc">尋神足跡紀錄</span>
        </div>
        <i class="fas fa-images" style="font-size:1.5rem; color:#bdbdbd;"></i>
    </a>

    <div class="footer-area">
        <div class="footer-text">
            2026 苑裡串起來<span class="mark-r">®</span> (Hotmail Ver.)
        </div>
    </div>

{% endblock %}

{% block scripts %}
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    $(document).ready(function() {
        $.getJSON('/api/locations', function(data) {
            if (data && data.length > 0) {
                var latest = data[data.length - 1]; 
                var nickname = latest.nickname || "熱心鄉親";
                var area = "苑裡某處";
                var desc = latest.description || "";
                
                if (desc.indexOf(']') > -1) {
                    var parts = desc.split(']');
                    if (parts.length > 0) area = parts[0].replace('[', ''); 
                }

                $('#news-ticker').html(`
                    <span style="color:#e65100;">最新情報：</span><br>
                    <b>${nickname}</b> 在 <b>${area}</b> 發現了土地公！
                `);
            } else {
                $('#news-ticker').html("歡迎來到尋神情報站！<br><span style='font-size:0.85rem;font-weight:normal;'>目前尚無情報，快來搶頭香</span>");
            }
        }).fail(function() {
            $('#news-ticker').html("歡迎來到尋神情報站！");
        });
    });
</script>
{% endblock %}
