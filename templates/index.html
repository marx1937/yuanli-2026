{% extends "base.html" %}
{% set active_page = "index" %}

{% block title %}å°‹ç¥æƒ…å ±ç«™ (Hç‰ˆ){% endblock %}

{% block styles %}
<style>
    /* å»¶çºŒæš–è‰²ç³»é¢¨æ ¼ */
    body {
        background-color: #fdfcf0;
        background-image: radial-gradient(#d7ccc8 1.5px, transparent 1.5px);
        background-size: 24px 24px;
    }

    /* é¦–é å°ˆå±¬ Hero å€å¡Š */
    .hero-section {
        text-align: center;
        padding: 30px 0 20px 0;
        margin-bottom: 10px;
        position: relative;
    }
    
    /* æ¨™é¡Œèˆ‡æ¨™è¨˜ */
    .app-title {
        font-family: 'Brush Script MT', cursive; 
        font-size: 3.5rem; 
        color: #5d4037; 
        margin: 0; 
        text-shadow: 2px 2px 0px #fff;
    }

    /* ğŸ”¥ Hç‰ˆå°ˆå±¬æ¨™è¨˜ */
    .version-tag {
        display: inline-block;
        background: #2d3436;
        color: #fab1a0;
        font-size: 0.8rem;
        padding: 4px 12px;
        border-radius: 20px;
        font-weight: bold;
        margin-top: 5px;
        box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    }

    /* ç‹€æ…‹è† å›Š */
    .status-pill {
        display: inline-flex;
        align-items: center;
        background: #fff;
        padding: 8px 20px;
        border-radius: 50px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        color: #8d6e63;
        font-weight: bold;
        margin-top: 15px;
        border: 1px solid #efebe9;
    }

    /* ğŸ”¥ å ±é¦¬ä»”è·‘é¦¬ç‡ˆ (å‹•æ…‹ç‰ˆ) */
    .notice-bar {
        background: #fff3e0;
        color: #e65100;
        padding: 12px 20px;
        border-radius: 15px;
        margin: 0 20px 20px 20px;
        font-size: 0.95rem;
        display: flex;
        align-items: center;
        border: 1px dashed #ffcc80;
        cursor: pointer;
        transition: transform 0.2s;
        box-shadow: 0 4px 10px rgba(230, 126, 34, 0.1);
    }
    .notice-bar:active { transform: scale(0.98); }
    .notice-icon { margin-right: 10px; animation: tada 1.5s infinite; }
    
    @keyframes tada {
        0% { transform: scale(1); }
        10%, 20% { transform: scale(0.9) rotate(-3deg); }
        30%, 50%, 70%, 90% { transform: scale(1.1) rotate(3deg); }
        40%, 60%, 80% { transform: scale(1.1) rotate(-3deg); }
        100% { transform: scale(1) rotate(0); }
    }

    /* å¤§æŒ‰éˆ•å¡ç‰‡é€šç”¨è¨­å®š */
    .action-card {
        margin: 0 20px 20px 20px;
        border-radius: 25px;
        padding: 25px 20px;
        position: relative;
        overflow: hidden;
        transition: transform 0.2s;
        cursor: pointer;
        display: flex;
        align-items: center;
        text-decoration: none !important;
        border: 1px solid rgba(255,255,255,0.5);
    }
    .action-card:active { transform: scale(0.98); }

    /* ç´…è‰² Lucky å¡ç‰‡ */
    .card-lucky {
        background: linear-gradient(135deg, #d32f2f 0%, #c62828 100%);
        color: white;
        box-shadow: 0 10px 25px rgba(211, 47, 47, 0.3);
    }
    .lucky-tag {
        position: absolute; right: -25px; top: 15px;
        background: #f1c40f; color: #d35400;
        font-weight: bold; padding: 5px 40px;
        transform: rotate(15deg);
        font-size: 0.8rem;
        box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }

    /* é»ƒè‰²åœ°åœ–å¡ç‰‡ */
    .card-map {
        background: linear-gradient(135deg, #fff8e1 0%, #ffecb3 100%);
        color: #5d4037;
        box-shadow: 0 10px 25px rgba(255, 193, 7, 0.2);
    }

    /* æ–‡å­—æ’ç‰ˆ */
    .card-text { flex: 1; margin-left: 15px; }
    .card-title { font-size: 1.4rem; font-weight: bold; margin-bottom: 5px; display: block; }
    .card-desc { font-size: 0.95rem; opacity: 0.9; }
    .card-icon { width: 70px; height: 70px; object-fit: contain; filter: drop-shadow(0 4px 4px rgba(0,0,0,0.1)); }

</style>
{% endblock %}

{% block content %}
    <div class="hero-section">
        <h1 class="app-title">MAP MY GOD</h1>
        
        <div class="version-tag">
            <i class="fab fa-hotjar"></i> Hotmail Hç‰ˆ
        </div>

        <br>
        <div class="status-pill">
            <span id="system-status">é€£ç·šæ–°ç¸½éƒ¨ä¸­...</span>
        </div>
    </div>

    <div class="notice-bar" onclick="location.href='/map'">
        <i class="fas fa-bullhorn notice-icon"></i>
        <span id="news-ticker">æ­£åœ¨æ¥æ”¶æœ€æ–°æƒ…å ±...</span>
        <i class="fas fa-chevron-right" style="margin-left: auto; opacity: 0.6;"></i>
    </div>

    <a href="/upload" class="action-card card-lucky">
        <div class="lucky-tag">LUCKY!</div>
        <img src="https://res.cloudinary.com/diuoghid2/image/upload/v1/mascot_camera.png" class="card-icon" alt="Lucky">
        <div class="card-text">
            <span class="card-title">å°‹æ‰¾ç¥éšŠå‹</span>
            <span class="card-desc">æ‹ç…§ä¸Šå‚³æ‹¿å¥½é‹</span>
        </div>
        <i class="fas fa-camera" style="font-size: 1.5rem; opacity: 0.8;"></i>
    </a>

    <a href="/map" class="action-card card-map">
        <img src="https://res.cloudinary.com/diuoghid2/image/upload/v1/mascot_map.png" class="card-icon" alt="Map">
        <div class="card-text">
            <span class="card-title">æœå°‹æ–¹ä½</span>
            <span class="card-desc">çœ‹çœ‹å¤§å®¶éƒ½å»å“ªæ‹œ</span>
        </div>
        <i class="fas fa-map-marked-alt" style="color: #ffb300; font-size: 1.5rem;"></i>
    </a>

    <div style="height: 100px;"></div>
{% endblock %}

{% block scripts %}
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    // ğŸ”¥ é¦–é ä¸€é€²ä¾†ï¼Œé¦¬ä¸Šå•è³‡æ–™åº«æœ€æ–°çš„æ¶ˆæ¯
    $(document).ready(function() {
        $.getJSON('/api/locations', function(data) {
            // 1. æ›´æ–°é€£ç·šç‹€æ…‹
            $('#system-status').html('âœ… Hotmail å°ˆç·šæš¢é€š');
            
            // 2. æ›´æ–°è·‘é¦¬ç‡ˆ
            if (data && data.length > 0) {
                // æ‹¿æœ€å¾Œä¸€ç­†è³‡æ–™ (æœ€æ–°ä¸Šå‚³)
                var latest = data[data.length - 1]; 
                
                // è™•ç†æè¿°æ–‡å­—ï¼Œé¿å…å¤ªé•·
                var desc = latest.description || "ç™¼ç¾æ–°ç¥è¹Ÿï¼";
                if(desc.length > 10) desc = desc.substring(0, 10) + "...";
                
                // é¡¯ç¤ºå…§å®¹
                $('#news-ticker').text("æœ€æ–°ï¼š[" + (latest.nickname || "ç†±å¿ƒé„‰è¦ª") + "] åœ¨è‹‘è£¡ä¸Šå‚³äº†ç…§ç‰‡ï¼");
            } else {
                // å¦‚æœæ–°è³‡æ–™åº«æ˜¯ç©ºçš„
                $('#news-ticker').text("ç›®å‰å°šç„¡æƒ…å ±ï¼Œå¿«ä¾†æ¶é ­é¦™ï¼");
            }
        }).fail(function() {
            $('#system-status').text("âš ï¸ è¨Šè™Ÿå¾®å¼±");
            $('#news-ticker').text("å ±é¦¬ä»”ä¼‘æ¯ä¸­ (é€£ç·šå•é¡Œ)");
        });
    });
</script>
{% endblock %}
