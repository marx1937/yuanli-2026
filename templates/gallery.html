<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è‹‘è£¡åœŸåœ°å…¬åœ–åº«</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <style>
        body { background-color: #fff8e1; padding-bottom: 70px; font-family: "Microsoft JhengHei", sans-serif; }
        
        .nav-header {
            background: linear-gradient(135deg, #d32f2f, #b71c1c);
            color: #ffeb3b;
            padding: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.2);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .filter-select {
            width: 100%;
            padding: 8px;
            border-radius: 20px;
            border: none;
            margin-top: 10px;
            font-weight: bold;
            color: #d32f2f;
        }

        .data-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin-bottom: 25px;
            border: none;
            transition: all 0.3s ease;
        }

        .card-img-box {
            height: 280px;
            overflow: hidden;
            position: relative;
            background-color: #eee;
        }
        
        .card-img-box img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .area-badge {
            position: absolute;
            top: 15px;
            left: 15px;
            background: rgba(211, 47, 47, 0.85);
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: bold;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .card-content { padding: 20px; }

        .note-box {
            background-color: #f8f9fa;
            border-left: 4px solid #ffc107;
            padding: 10px;
            margin-top: 10px;
            border-radius: 4px;
            color: #555;
            font-size: 0.95rem;
            line-height: 1.5;
        }

        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: white;
            display: flex;
            justify-content: space-around;
            padding: 10px 0;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
            z-index: 1000;
        }
        .nav-btn {
            color: #888;
            text-align: center;
            text-decoration: none;
            font-size: 0.8rem;
        }
        .nav-btn.active { color: #d32f2f; font-weight: bold; }
        .nav-btn i { font-size: 1.2rem; display: block; margin-bottom: 2px; }
    </style>
</head>
<body>

    <div class="nav-header">
        <div class="d-flex justify-content-between align-items-center">
            <h5 class="m-0 font-weight-bold"><i class="fas fa-images"></i> åœŸåœ°å…¬åœ–åº«ç‰†</h5>
            <span class="badge badge-light" id="count-badge">å…¨éƒ¨</span>
        </div>
        
        <select id="areaFilter" class="filter-select" onchange="filterData()">
            <option value="all">ğŸ“ é¡¯ç¤ºå…¨è‹‘è£¡</option>
            <option value="è‹‘æ±é‡Œ">è‹‘æ±é‡Œ</option>
            <option value="è‹‘å—é‡Œ">è‹‘å—é‡Œ</option>
            <option value="è‹‘åŒ—é‡Œ">è‹‘åŒ—é‡Œ</option>
            <option value="è¥¿å‹¢é‡Œ">è¥¿å‹¢é‡Œ</option>
            <option value="ä¸­æ­£é‡Œ">ä¸­æ­£é‡Œ</option>
            <option value="å®¢åº„é‡Œ">å®¢åº„é‡Œ</option>
            <option value="è‹‘æ¸¯é‡Œ">è‹‘æ¸¯é‡Œ</option>
            <option value="è¥¿å¹³é‡Œ">è¥¿å¹³é‡Œ</option>
            <option value="æµ·å²¸é‡Œ">æµ·å²¸é‡Œ</option>
            <option value="æˆ¿è£¡é‡Œ">æˆ¿è£¡é‡Œ</option>
            <option value="æ–°å¾©é‡Œ">æ–°å¾©é‡Œ</option>
            <option value="ç”°å¿ƒé‡Œ">ç”°å¿ƒé‡Œ</option>
            <option value="èˆŠç¤¾é‡Œ">èˆŠç¤¾é‡Œ</option>
            <option value="å±±è…³é‡Œ">å±±è…³é‡Œ</option>
            <option value="ç¦ç”°é‡Œ">ç¦ç”°é‡Œ</option>
            <option value="è•‰åŸ”é‡Œ">è•‰åŸ”é‡Œ</option>
            <option value="çŸ³é®é‡Œ">çŸ³é®é‡Œ</option>
            <option value="å—å‹¢é‡Œ">å—å‹¢é‡Œ</option>
            <option value="ç‰ç”°é‡Œ">ç‰ç”°é‡Œ</option>
            <option value="æ³°ç”°é‡Œ">æ³°ç”°é‡Œ</option>
            <option value="ä¸Šé¤¨é‡Œ">ä¸Šé¤¨é‡Œ</option>
            <option value="æ°´å¡é‡Œ">æ°´å¡é‡Œ</option>
            <option value="ç¤¾è‹“é‡Œ">ç¤¾è‹“é‡Œ</option>
            <option value="å±±æŸ‘é‡Œ">å±±æŸ‘é‡Œ</option>
            <option value="å…¶ä»–">å…¶ä»–</option>
        </select>
    </div>

    <div class="container mt-4">
        {% if rows|length == 0 %}
            <div class="text-center text-muted mt-5">
                <p>é‚„æ²’æœ‰ç…§ç‰‡å–”ï¼Œå¿«å»ç•¶ç¬¬ä¸€å€‹ä¸Šå‚³çš„äººï¼</p>
                <a href="/report" class="btn btn-danger mt-3">æˆ‘è¦ä¸Šå‚³</a>
            </div>
        {% endif %}

        {% for row in rows %}
        <div class="data-card" data-area="{{ row[2] }}">
            <div class="card-img-box">
                <a href="{{ row[0] }}" target="_blank">
                    <img src="{{ row[0] }}" loading="lazy">
                </a>
                <span class="area-badge">
                    <i class="fas fa-map-marker-alt"></i> {{ row[2] }}
                </span>
            </div>
            
            <div class="card-content">
                <div class="d-flex justify-content-between align-items-center">
                    <h5 class="mb-0 font-weight-bold text-dark">
                        <i class="fas fa-user-circle text-secondary"></i> {{ row[1] or 'ç†±å¿ƒä¸²å‹' }}
                    </h5>
                    <small class="text-muted">{{ row[4].strftime('%Y-%m-%d') }}</small>
                </div>
                
                <div class="note-box">
                    {% if row[3] %}
                        {{ row[3] }}
                    {% else %}
                        <em class="text-muted">ï¼ˆä¿¡å¾’æ²’æœ‰ç•™ä¸‹æ•…äº‹...ï¼‰</em>
                    {% endif %}
                </div>
            </div>
        </div>
        {% endfor %}
        
        <div id="no-result" class="text-center text-muted mt-5" style="display: none;">
            <i class="fas fa-search mb-3" style="font-size: 2rem;"></i>
            <p>é€™å€‹é‡Œç›®å‰é‚„æ²’æœ‰äººä¸Šå‚³ç…§ç‰‡å–”ï¼</p>
        </div>
    </div>

    <div class="bottom-nav">
        <a href="/" class="nav-btn">
            <i class="fas fa-home"></i> é¦–é 
        </a>
        <a href="/map" class="nav-btn">
            <i class="fas fa-map-marked-alt"></i> åœ°åœ–
        </a>
        <a href="/gallery" class="nav-btn active">
            <i class="fas fa-images"></i> åœ–åº«
        </a>
        <a href="/report" class="nav-btn" style="color: #d32f2f;">
            <i class="fas fa-camera"></i> æŸ¥å ±
        </a>
    </div>

    <script>
        function filterData() {
            var selectedArea = document.getElementById('areaFilter').value;
            var cards = document.getElementsByClassName('data-card');
            var visibleCount = 0;

            for (var i = 0; i < cards.length; i++) {
                var cardArea = cards[i].getAttribute('data-area');
                if (selectedArea === 'all' || cardArea === selectedArea) {
                    cards[i].style.display = 'block';
                    visibleCount++;
                } else {
                    cards[i].style.display = 'none';
                }
            }
            var badge = document.getElementById('count-badge');
            if(selectedArea === 'all') {
                badge.innerText = 'å…¨éƒ¨ (' + visibleCount + ')';
            } else {
                badge.innerText = selectedArea + ' (' + visibleCount + ')';
            }
            if (visibleCount === 0) {
                document.getElementById('no-result').style.display = 'block';
            } else {
                document.getElementById('no-result').style.display = 'none';
            }
        }
        filterData();
    </script>
</body>
</html>
